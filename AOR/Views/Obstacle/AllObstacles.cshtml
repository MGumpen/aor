@model IEnumerable<AOR.Models.ReportModel>

@{
    ViewData["Title"] = "All Registered Obstacles";
    Layout = "_Layout";
}

<link rel="stylesheet" href="~/css/Obstacle/AllObstacles.css" />


<section class="container">
    <div class="header">
        <h1>All Registered Obstacles</h1>
        <p style="color: #64748b;">Complete overview of all aviation obstacles in the system</p>
    </div>
    
    <div class="actions-bar">
        <a href="/Crew" class="btn btn-primary">Back to map</a>
        <div class="stats">
            <div><strong>Total:</strong> @Model.Count() reports</div>
            <div><strong>Lines:</strong> @Model.Count(x => x.Obstacle?.ObstacleType?.ToLower() == "line")</div>
            <div><strong>Masts:</strong> @Model.Count(x => x.Obstacle?.ObstacleType?.ToLower() == "mast")</div>
            <div><strong>Other:</strong> @Model.Count(x => x.Obstacle?.ObstacleType?.ToLower() == "other")</div>
        </div>

    </div>
    
    @if (Model.Any())
    {
        <div class="obstacles-grid">
            @foreach (var report in Model.OrderByDescending(x => x.CreatedAt))
            {
                <div class="obstacle-card">
                    <div class="obstacle-header">
                        <h3 class="obstacle-name">@(report.Obstacle?.ObstacleName ?? "Unnamed")</h3>
                        <span class="obstacle-type-badge badge-@(report.Obstacle?.ObstacleType?.ToLower() ?? "unknown")">
                            @(report.Obstacle?.ObstacleType ?? "Unknown")
                        </span>
                    </div>
                    
                    <div class="obstacle-details">
                        @if (report.Obstacle?.ObstacleHeight.HasValue == true)
                        {
                            <div class="detail-item">
                                <div class="detail-label">Height:</div>
                                <div class="detail-value">@report.Obstacle.ObstacleHeight.Value.ToString("F1") m</div>
                            </div>
                        }
                        
                        <div class="detail-item">
                            <div class="detail-label">Points:</div>
                            <div class="detail-value">@(report.Obstacle?.PointCount ?? 0)</div>
                        </div>
                        
                        <div class="detail-item">
                            <div class="detail-label">Registered:</div>
                            <div class="detail-value">@report.CreatedAt.ToString("dd.MM.yyyy")</div>
                        </div>
                        
                        @if (report.Obstacle?.ObstacleType?.ToLower() == "mast" && !string.IsNullOrEmpty(report.Obstacle.MastType))
                        {
                            <div class="detail-item">
                                <div class="detail-label">Type:</div>
                                <div class="detail-value">@report.Obstacle.MastType</div>
                            </div>
                        }
                    </div>
                    
                    @if (!string.IsNullOrEmpty(report.Obstacle?.ObstacleDescription))
                    {
                        <div class="obstacle-description">
                            @(report.Obstacle.ObstacleDescription.Length > 100 ? 
                              report.Obstacle.ObstacleDescription.Substring(0, 100) + "..." : 
                              report.Obstacle.ObstacleDescription)
                        </div>
                    }
                    
                    <div class="obstacle-actions">
                        <a asp-controller="Report" asp-action="ReportDetails" asp-route-id="@report.ReportId" class="btn-small btn-details">View Details</a>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <div class="empty-state">
            <div class="empty-icon">üìç</div>
            <h3>No Obstacles Registered</h3>
            <p>No aviation obstacles have been registered yet.</p>
        </div>
    }
</section>
